# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
# Copyright (C) 2022 - 2024 Texas Instruments Incorporated
%YAML 1.2
---
$id: http://devicetree.org/schemas/sound/ti,tasdevice.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: Texas Instruments tasdevice

maintainers:
  - Shenghao Ding <shenghao-ding@ti.com>
  - Kevin Lu <kevin-lu@ti.com>

description: |
  The tasdevice driver offer a flexible architecture to set the device number
  and registers in a bin file.

  Specifications about the audio amplifier can be found at:
    https://www.ti.com/lit/gpn/pcm9211
    https://www.ti.com/lit/gpn/tas2110
    https://www.ti.com/lit/gpn/tas2120
    https://www.ti.com/lit/gpn/tas2320
    https://www.ti.com/lit/gpn/tas2560
    https://www.ti.com/lit/gpn/tas2562
    https://www.ti.com/lit/gpn/tas2564
    https://www.ti.com/lit/gpn/tas2572
    https://www.ti.com/lit/gpn/tas2764
    https://www.ti.com/lit/gpn/tas2770
    https://www.ti.com/lit/gpn/tas2780
    https://www.ti.com/lit/gpn/tas5805m
    https://www.ti.com/lit/gpn/tas5806m
    https://www.ti.com/lit/gpn/tas5806md
    https://www.ti.com/lit/gpn/tas5822m
    https://www.ti.com/lit/gpn/tas5825m
    https://www.ti.com/lit/gpn/tas5825p
    https://www.ti.com/lit/gpn/tas5827
    https://www.ti.com/lit/gpn/tas5828m

properties:
  compatible:
    description: |
      ti,pcm9211s: 216-kHz Digital Audio Interface Transceiver (DIX)
      With Stereo ADC and Routing.

      ti,tas2110: 6.1-W Digital Input Audio Class-D Amplifier With
      Integrated 11-V Class-H Boost.

      ti,tas2120: 8.2W Mono Digital Input Class-D Speaker Amp with
      Integrated 14.75V Class-H Boost.

      ti,tas2320: 15W Mono Digital Input Class-D Speaker Amp with 15V
      Support

      ti,tas2560: 5.6-W Class-D Mono Audio Amplifier with IV Sense.

      ti,tas2562: 6.1-W Boosted Class-D Audio Amplifier with IV Sense.

      ti,tas2564: 7-W Class-D Smart Amp With Integrated 13-V Class-H
      boost &I/V Sense for Speaker Protection.

      ti,tas2572: 6.6 W Digital Input smart amp with I/V sense and
      integrated 13 V Class-H Boost.

      ti,tas2764: 13-W Digital Input Mono Class-D Audio Amplifier With
      Speaker IV Sense.

      ti,tas2770: 20-W Digital Input Mono Class-D Audio Amplifier
      with Speaker I/V Sense.

      ti,tas2780: 30-W Digital Input Mono Class-D Audio Amplifier With
      Speaker IV Sense.

      ti,tas5805: 23-W, Inductor-Less, Digital Input, Stereo, Closed-Loop
      Class-D Audio Amplifier with Enhanced Processing and Low Power
      Dissipation.

      ti,tas5806m: 23-W, Inductor-Less, Digital Input, Stereo, Closed-Loop
      Class-D Audio Amplifier with Enhanced Processing and Low Power
      Dissipation.

      ti,tas5806md: 23-W, Inductor-Less, Digital Input, Stereo, Closed-Loop
      Class-D Audio Amplifier with Enhanced Processing and DirectPathTM HP
      Driver.

      ti,tas5822: 35-W, Digital Input, Stereo, Closed-Loop Class-D Audio
      Amplifier with 96kHz Enhanced Processing.

      ti,tas5825m: 4.5 V to 26.4 V, 38-W Stereo, Inductor-Less, Digital Input,
      Closed-Loop Class-D Audio Amplifier with 192-kHz Extended Audio
      Processing.

      ti,tas5825p: 4.5 V to 26.4 V, 38 W Stereo, Digital Input, High
      Efficiency Closed-Loop Class-D Audio Amplifier with Hybrid-Pro
      Algorithm.

      ti,tas5827: 47-W Stereo, Digital Input, High Efficiency Closed-Loop
      Class-D Amplifier with Class-H Algorithm.

      ti,tas5828: 50-W stereo, digital input, high-performance,
      closed-loop, Class-D, with integrated audio processor
    enum:
      - ti,pcm9211s
      - ti,tas2020      
      - ti,tas2110
      - ti,tas2118
      - ti,tas2120
      - ti,tas2320
      - ti,tas2560
      - ti,tas2562
      - ti,tas2564
      - ti,tas257x
      - ti,tas2764
      - ti,tas2770
      - ti,tas2780
      - ti,tas5802
      - ti,tas5805
      - ti,tas5806m
      - ti,tas5806md
      - ti,tas5822
      - ti,tas5825m
      - ti,tas5825p
      - ti,tas5827
      - ti,tas5828

  reg:
    description:
      I2C address, in multiple tasdevices case, all the i2c address
      aggregate as one Audio Device to support multiple audio slots.
    maxItems: 8
    minItems: 1

  reset-gpios:
    maxItems: 1
    description: |
      A GPIO line handling reset of the chip. As the line is active high,
      it should be marked GPIO_ACTIVE_HIGH.

  interrupts:
    maxItems: 1

  '#sound-dai-cells':
    const: 0

required:
  - compatible
  - reg

allOf:
  - $ref: dai-common.yaml#
  - if:
      properties:
        compatible:
          contains:
            enum:
              - ti,pcm9211s
    then:
      properties:
        reg:
          description:
            I2C address, in multiple-device case, all the i2c address
            aggregate as one Audio Device to support multiple audio slots.
          maxItems: 4
          minItems: 1
          items:
            minimum: 0x40
            maximum: 0x43

  - if:
      properties:
        compatible:
          contains:
            enum:
              - ti,tas2110
              - ti,tas2560
              - ti,tas2562
              - ti,tas2564
              - ti,tas257x
    then:
      properties:
        reg:
          description:
            I2C address, in multiple-AMP case, all the i2c address
            aggregate as one Audio Device to support multiple audio slots.
          maxItems: 4
          minItems: 1
          items:
            minimum: 0x4c
            maximum: 0x4f

  - if:
      properties:
        compatible:
          contains:
            enum:
              - ti,tas2764
              - ti,tas2780
    then:
      properties:
        reg:
          description:
            I2C address, in multiple-AMP case, all the i2c address
            aggregate as one Audio Device to support multiple audio slots.
          maxItems: 8
          minItems: 1
          items:
            minimum: 0x38
            maximum: 0x3f

  - if:
      properties:
        compatible:
          contains:
            enum:
              - ti,tas2770
    then:
      properties:
        reg:
          description:
            I2C address, in multiple-AMP case, all the i2c address
            aggregate as one Audio Device to support multiple audio slots.
          maxItems: 8
          minItems: 1
          items:
            minimum: 0x41
            maximum: 0x48

additionalProperties: false

examples:
  - |
   #include <dt-bindings/gpio/gpio.h>
   i2c {
     /* example for three devices with interrupt support */
     #address-cells = <1>;
     #size-cells = <0>;
     three: tasdevice@4f {
       compatible = "ti,tas257x";
       reg = <0x4f>, /* primary-device */
              <0x4c>, /* secondary-device */
              <0x4e>; /* tertiary-device */
       #sound-dai-cells = <0>;
       reset-gpios = < &gpio1 10 GPIO_ACTIVE_HIGH >;
       interrupt-parent = <&gpio1>;
       interrupts = <15>;
     };
   };
  - |
   #include <dt-bindings/gpio/gpio.h>
   i2c {
     /* example for one device without interrupt support*/
     #address-cells = <1>;
     #size-cells = <0>;
     one: tasdevice@4d {
       compatible = "ti,tas257x";
       reg = <0x4d>;
       #sound-dai-cells = <0>;
       reset-gpios = < &gpio1 10 GPIO_ACTIVE_HIGH >;
     };
   };
...
